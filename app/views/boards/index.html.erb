<h1>みんなの投稿</h1>

<div class="grid gap-6">
  <% @boards.each do |board| %>
    <%= link_to board_path(board), class: "block rounded-md" do %>
      <div class="p-6 border border-stone-200 rounded-lg shadow-sm bg-white">
        <!-- ユーザー名 -->
        <div class="mb-4">
          <p>投稿者： <%= board.user.name %></p>
        </div>

        <!-- 目標 -->
        <div class="mb-4">
          <% if board.goal_title.present? %>
            <div class="text-sm space-y-1">
              <p><span class="font-medium">目標：</span> <%= board.goal_title %></p>
              <p><span class="font-medium">内容：</span> <%= board.goal_content %></p>
              <% if board.goal_reward.present? %>
                <p><span class="font-medium">達成報酬：</span> <%= board.goal_reward %></p>
              <% end %>
              <% if board.goal_punishment.present? %>
                <p><span class="font-medium">ペナルティ：</span> <%= board.goal_punishment %></p>
              <% end %>
            </div>
          <% end %>
        </div>

        <!-- ストレッチ -->
        <div class="mb-4">
          <p class="text-center mb-2">今日のストレッチ</p>
            <% if board.did_stretch %>
              <div class="flex flex-col items-center text-2xl text-green-600 scale-110">
                <div class="icon-circle w-12 h-12 flex items-center justify-center border-2 rounded-full border-green-500">
                ◯
                </div>
                <span class="text-sm mt-1">やった！</span>
              </div>
            <% else %>
              <div class="flex flex-col items-center text-2xl text-red-600 scale-110">
                <div class="icon-circle w-12 h-12 flex items-center justify-center border-2 rounded-full border-red-500">
                ✕
                </div>
                <span class="text-sm mt-1">やってない！</span>
              </div>
          <% end %>
        </div>

        <!-- 本文 -->
        <div class="mb-4">
          <% if board.content.present? %>
            <div class="bg-amber-50 p-4 rounded-md">
              <p class="whitespace-pre-wrap"><%= simple_format(board.content) %></p>
            </div>
          <% end %>
        </div>

        <!-- 前屈レベル画像 -->
        <div class="mb-7">
          <% if board.flexibility_level.present? %>
            <p class="text-center mb-2">前屈レベル</p>
            <div class="flex justify-center">
              <div class="w-32">
                <img src="<%= asset_path("zenkutsu_level_#{format('%02d', board.flexibility_level)}.jpg") %>" alt="前屈する人" class="rounded-md shadow-md" />
              </div>
            </div>
          <% end %>
        </div>

        <!-- 添付画像（ActiveStorage）-->
        <div class="mb-2">
        <% if board.image.attached? %>
          <div class="flex justify-center">
            <%= image_tag board.display_image, class: "rounded-md shadow-md max-w-xs" %>
          </div>
        <% end %>
        </div>

        <!-- 投稿日と応援ボタン -->
        <div class="flex justify-between items-center">
          <p class="text-xs text-stone-400">投稿日: <%= l(board.created_at, format: :long) %></p>
          <%= render "cheers/btn", board: board %>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
